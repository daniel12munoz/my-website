@import url('./austin.css');

:root {
  --home-nudge: 45px;
  --home-mobile-desc-scale: 0.85;
}

.home {
  position: relative;
  min-height: 100svh;
  height: auto;
  overflow-x: hidden;
  background: #ffffff;
  color: var(--au-ink);
  display: grid;
  grid-template-rows: auto auto auto;
  align-content: start;
  row-gap: clamp(10px, 2vh, 18px);
  padding-top: max(clamp(56px, 7vh, 96px), env(safe-area-inset-top));
  padding-right: clamp(18px, 4vw, 46px);
  padding-bottom: clamp(18px, 3vw, 34px);
  padding-left: clamp(18px, 4vw, 46px);
  transform: none;
  will-change: auto;
  justify-items: center;
}

/* If the outer app wrapper adds extra padding/margins, DO NOT change it globally.
   Only adjust .home padding via clamp() if needed to eliminate overflow. */

.home__spotlight {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;

  /* EXTREMELY SUBTLE spotlight - NO COLOR TINT */
  background:
    radial-gradient(
      circle at 50% 46%,
      rgba(0,0,0,0.06) 0%,
      rgba(0,0,0,0.035) 18%,
      rgba(0,0,0,0.015) 34%,
      rgba(0,0,0,0.00) 56%
    );
}

.home__top,
.home__center,
.home__bottom {
  position: relative;
  z-index: 1;
  /* Desktop: center the Home content column inside the available main area */
  width: 100%;
  max-width: 1100px;
  margin-left: auto;
  margin-right: auto;
}

/* HEADLINE placement */
.home__top {
  display: flex;
  justify-content: center;           /* MUST BE CENTERED (user complained it wasn't) */
  align-items: flex-start;

  /* Increased drop: ~50% more than previous */
  margin-top: clamp(48px, 9vh, 108px);

  /* Ensure headline stays above hero shadow */
  position: relative;
  z-index: 5;
}

.home__headline {
  margin: 0;
  font-family: 'IBM Plex Serif', 'Georgia', 'Times New Roman', serif;
  font-weight: 500;
  font-size: clamp(34px, 5vw, 64px);
  line-height: 1.05;
  letter-spacing: 0.01em;
  text-align: center;

  /* IMPORTANT: remove transforms so it cannot clip */
  transform: none;
  will-change: auto;
}

.home__it {
  font-style: italic;
  text-decoration: underline;
  text-underline-offset: 6px;
  text-decoration-thickness: 2px;
}

/* CENTER illustration */
.home__center {
  display: grid;
  place-items: center;
  /* tighten vertical spacing slightly */
  padding-top: clamp(8px, 2vh, 20px);
}

.home__heroArt {
  margin: 0;
  width: 100%;
  max-width: 920px;
  display: grid;
  place-items: center;
}

/* Composite wrapper: does NOT affect layout size, just enables layering */
.home__heroComposite {
  position: relative;
  width: 100%;
  display: block;
  isolation: isolate;
  height: auto;

  /* Hero composite (video + PNG + shadow) sits below text */
  z-index: 1;

  /* Shadow/glow behind the hero WITHOUT changing layout */
  filter:
    drop-shadow(0 18px 22px rgba(0,0,0,0.18))
    drop-shadow(0 42px 60px rgba(0,0,0,0.12))
    drop-shadow(0 80px 120px rgba(0,0,0,0.08));
}

/* Keep the image on top */
.home__heroComposite .home__heroImg {
  position: relative;
  z-index: 2;
  display: block;
  width: 100%;
  height: auto;
  border: none;
  border-radius: 0;
  box-shadow: none;
  max-width: 100%;
  pointer-events: none;
}

/* Video behind image, same footprint as image */
.home__tvStatic {
  position: absolute;
  inset: 0;
  z-index: 1;

  /* keep same vertical size as before */
  height: 100%;

  /* squash width without moving anything else */
  width: 100%;
  transform: translateY(-75px) scale(0.5) scaleX(0.70);
  transform-origin: center;

  /* keep filling the visible area */
  object-fit: cover;

  pointer-events: none;
}

/* Fallback placeholder (visible only when img fails to l
oad) */
.home__heroFallback {
  width: 100%;
  height: clamp(310px, 48vh, 620px);
  background: rgba(0,0,0,0.06);
  border: none;
  border-radius: 0;
  box-shadow: none;
  filter: none; /* keep fallback flat */
  max-width: 100%;
}

/* BOTTOM copy */
.home__bottom {
  display: flex;
  justify-content: center;
  align-items: flex-end;

  /* FINAL micro-drop (~20px) */
  margin-top: clamp(20px, 0vh, -30px);

  padding-bottom: clamp(12px, 2vh, 28px);

  /* Ensure bottom copy stays above hero shadow */
  position: relative;
  z-index: 5;
}

.home__copy {
  margin: 0;
  max-width: 72ch;
  color: var(--au-muted);
  font-size: clamp(16px, 2.0vw, 22px);
  line-height: 1.55;
  text-align: center;
}

.home__copyLine {
  display: block;                    /* FORCE two lines */
}

/* Provide a small, intentional gap between the two lines */
.home__copyLine + .home__copyLine {
  margin-top: 8px;
}

/* Responsive */
@media (max-width: 760px) {
  .home__headline {
    font-size: clamp(30px, 7vw, 46px);
  }

  .home__center {
    padding-top: 10px;
  }

  .home__heroArt {
    width: min(680px, 92vw);
  }

  .home__heroFallback {
    height: clamp(240px, 40vh, 420px);
  }

  .home__copy {
    max-width: 46ch;
    font-size: clamp(15px, 3.8vw, 18px);
  }
}

/* Desktop: tvScreen hidden by default */
.home__tvScreen {
  display: none;
}

/* Mobile (<= 600px): fixed non-scrollable poster, flex-centered, single rule set */
@media (max-width: 600px) {
  .home {
    /* Mobile poster: center everything */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;

    /* No scrolling inside Home; fill main content area (main has padding-bottom for shadow) */
    min-height: 100%;
    height: 100%;

    /* Keep safe areas */
    padding-top: max(56px, env(safe-area-inset-top));
    padding-bottom: max(24px, env(safe-area-inset-bottom));
    padding-left: 16px;
    padding-right: 16px;

    /* Transform applied to .mobileHomeGroup instead; no double shift */
    transform: none;
    overflow: visible;
  }

  .home__top,
  .home__center,
  .home__bottom {
    width: 100%;
    max-width: 420px;
    margin-left: auto;
    margin-right: auto;
    display: flex;
    justify-content: center;
  }

  .home__top {
    margin-top: 0;
  }

  .home__headline {
    font-size: clamp(28px, 8vw, 44px);
    text-align: center;
  }

  .home__center {
    padding-top: 10px;
    overflow: visible !important;
  }

  .home__heroArt {
    width: 100%;
    max-width: 420px;
    padding-inline: 0;
    overflow: visible !important;
  }

  .home__heroComposite {
    width: 100%;
    max-width: 420px;
    margin: 0 auto;
    position: relative;
    overflow: visible !important;
  }

  /* Hide desktop static on mobile */
  .home__tvStatic {
    display: none !important;
    opacity: 0 !important;
    visibility: hidden !important;
  }

  /* TV screen: static video clipped inside screen (single source of truth) */
  .home__tvScreen {
    display: block !important;
    position: absolute !important;
    top: 12% !important;
    left: 34% !important;
    width: 32% !important;
    height: 44% !important;
    overflow: hidden !important;
    border-radius: 6px !important;
    z-index: 2 !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  .home__tvScreen video,
  .home__tvStaticScreen {
    position: absolute !important;
    inset: 0 !important;
    width: 100% !important;
    height: 100% !important;
    display: block !important;
    object-fit: cover !important;
    object-position: center !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  .home__heroComposite .home__heroImg {
    position: relative;
    z-index: 3;
  }

  .home__bottom {
    padding-inline: 0;
  }

  .home__copy {
    width: min(92vw, 46ch);
    max-width: none;
    font-size: clamp(13.95px, 3.6vw, 17px);
    line-height: 1.5;
    padding-inline: 0;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
  }
}

/* ===========================
   MID-DESKTOP BALANCE (Mac ~1173px)
   Make Home column slightly narrower so it doesn't feel shoved right
   =========================== */
@media (min-width: 980px) and (max-width: 1250px) {
  /* Narrow the overall Home content column a bit */
  section#home.home.au .home__top,
  section#home.home.au .home__center,
  section#home.home.au .home__bottom {
    max-width: 980px !important;
  }

  /* Narrow the hero artwork so it doesn't fill the whole main area */
  section#home.home.au .home__heroArt {
    max-width: 860px !important;
  }
}

/* =========================================================
   DESKTOP (min-width: 601px): restore fixed height, overflow, transform
   HOME PAGE: Desktop hero drop-shadow loading flicker fix
   ========================================================= */
@media (min-width: 601px) {
  /* Desktop home: fixed viewport height and nudge (pixel-identical to previous) */
  #home.home {
    height: 100vh;
    overflow: hidden;
    transform: translate(13px, calc(-50px - var(--home-nudge)));
    will-change: transform;
  }

  /* Ensure hero containers don't clip the drop-shadow */
  #home.home .home__center,
  #home.home .home__heroArt,
  #home.home .home__heroComposite {
    overflow: visible !important;
  }

  /* Prevent GPU repaint flicker and ensure stable rendering */
  #home.home .home__heroComposite {
    contain: paint;
    will-change: transform;
  }

  /* Ensure image and video render as block elements immediately */
  #home.home .home__heroComposite .home__heroImg,
  #home.home .home__heroComposite .home__tvStatic {
    display: block;
  }

  /* Reserve space and prevent shadow pop-in for hero image */
  #home.home .home__heroImg {
    width: 100%;
    height: auto;
  }
}

/* =========================================================
   MOBILE HOME: scroll lock + viewport/group centering
   Only when body.mobile-home-locked (homepage on mobile).
   No X nudges; vertical centering via grid + responsive translateY.
   ========================================================= */
html.mobile-home-locked,
body.mobile-home-locked {
  height: 100%;
  overflow: hidden;
  overscroll-behavior: none;
  touch-action: manipulation;
}

@media (max-width: 600px) {
  body.mobile-home-locked .mobileHomeViewport {
    width: 100%;
    min-height: 100vh;
    min-height: 100svh;
    min-height: 100dvh;
    height: 100vh;
    height: 100svh;
    height: 100dvh;
    display: grid;
    place-items: center;
    padding-top: env(safe-area-inset-top);
    padding-right: env(safe-area-inset-right);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    overflow: hidden;
    overscroll-behavior: none;
    box-sizing: border-box;
  }

  body.mobile-home-locked .mobileHomeGroup {
    --mobileHeroYOffset: calc(clamp(4px, 1.2vh, 10px) - 18px);
    width: 100%;
    max-width: min(92vw, 420px);
    margin-inline: auto;
    transform: translateY(var(--mobileHeroYOffset));
    display: flex;
    flex-direction: column;
    align-items: center;
    box-sizing: border-box;
  }
}

